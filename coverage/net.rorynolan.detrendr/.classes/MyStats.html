


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: MyStats</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">net.rorynolan.detrendr</a> ]
</div>

<h1>Coverage Summary for Class: MyStats (net.rorynolan.detrendr)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MyStats</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    57.9%
  </span>
  <span class="absValue">
    (11/ 19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    54.2%
  </span>
  <span class="absValue">
    (58/ 107)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;package net.rorynolan.detrendr;
<i>2</i>&nbsp;
<i>3</i>&nbsp;import Jama.Matrix;
<i>4</i>&nbsp;import ij.ImagePlus;
<i>5</i>&nbsp;import ij.ImageStack;
<i>6</i>&nbsp;import org.apache.commons.math3.stat.descriptive.SummaryStatistics;
<i>7</i>&nbsp;
<i>8</i>&nbsp;import java.util.zip.DataFormatException;
<i>9</i>&nbsp;
<b class="nc"><i>10</i>&nbsp;class MyStats {</b>
<i>11</i>&nbsp;
<i>12</i>&nbsp;  private static long sum(int[] data) {
<b class="nc"><i>13</i>&nbsp;    long sum = 0;</b>
<b class="nc"><i>14</i>&nbsp;    for(int a : data)</b>
<b class="nc"><i>15</i>&nbsp;      sum += a;</b>
<b class="nc"><i>16</i>&nbsp;    return sum;</b>
<i>17</i>&nbsp;  }
<i>18</i>&nbsp;  static double sum(double[] data) {
<b class="fc"><i>19</i>&nbsp;    double sum = 0.0;</b>
<b class="fc"><i>20</i>&nbsp;    for(double a : data)</b>
<b class="fc"><i>21</i>&nbsp;      sum += a;</b>
<b class="fc"><i>22</i>&nbsp;    return sum;</b>
<i>23</i>&nbsp;  }
<i>24</i>&nbsp;
<i>25</i>&nbsp;  private static double mean(int[] data) {
<b class="nc"><i>26</i>&nbsp;    return sum(data) / data.length;</b>
<i>27</i>&nbsp;  }
<i>28</i>&nbsp;  static double mean(double[] data) {
<b class="fc"><i>29</i>&nbsp;    return sum(data) / data.length;</b>
<i>30</i>&nbsp;  }
<i>31</i>&nbsp;
<i>32</i>&nbsp;  static double var(int[] data) {
<b class="nc"><i>33</i>&nbsp;    double mean = mean(data);</b>
<b class="nc"><i>34</i>&nbsp;    double temp = 0;</b>
<b class="nc"><i>35</i>&nbsp;    for(double a : data)</b>
<b class="nc"><i>36</i>&nbsp;      temp += (a - mean) * (a - mean);</b>
<b class="nc"><i>37</i>&nbsp;    return temp / (data.length - 1);</b>
<i>38</i>&nbsp;  }
<i>39</i>&nbsp;  static double var(double[] data) {
<b class="fc"><i>40</i>&nbsp;    double mean = mean(data);</b>
<b class="fc"><i>41</i>&nbsp;    double temp = 0;</b>
<b class="fc"><i>42</i>&nbsp;    for(double a : data)</b>
<b class="fc"><i>43</i>&nbsp;      temp += (a - mean) * (a - mean);</b>
<b class="fc"><i>44</i>&nbsp;    return temp / (data.length - 1);</b>
<i>45</i>&nbsp;  }
<i>46</i>&nbsp;
<i>47</i>&nbsp;  static double brightnessB(int[] data) {
<b class="nc"><i>48</i>&nbsp;    double mean = mean(data);</b>
<b class="nc"><i>49</i>&nbsp;    double temp = 0;</b>
<b class="nc"><i>50</i>&nbsp;    for(double a : data)</b>
<b class="nc"><i>51</i>&nbsp;      temp += (a - mean) * (a - mean);</b>
<b class="nc"><i>52</i>&nbsp;    double var = temp / (data.length - 1);</b>
<b class="nc"><i>53</i>&nbsp;    return var / mean;</b>
<i>54</i>&nbsp;  }
<i>55</i>&nbsp;  private static double brightnessB(SummaryStatistics sumStat) {
<b class="fc"><i>56</i>&nbsp;    return sumStat.getVariance() / sumStat.getMean();</b>
<i>57</i>&nbsp;  }
<i>58</i>&nbsp;  static Matrix brightnessB(ImagePlus imPlus)
<i>59</i>&nbsp;          throws DataFormatException {
<b class="nc"><i>60</i>&nbsp;    ImagePlus myImPlus = MyImg.makeMine(imPlus);</b>
<b class="nc"><i>61</i>&nbsp;    int[] d = myImPlus.getDimensions();</b>
<b class="nc"><i>62</i>&nbsp;    if (d[2] != 1) {</b>
<b class="nc"><i>63</i>&nbsp;      DataFormatException e = new DataFormatException(</b>
<i>64</i>&nbsp;              &quot;Can only calculate the brightness of a 1-channel ImagePlus. &quot; +
<i>65</i>&nbsp;                      &quot;\n  * You have attempted to calculate the brightness &quot; +
<i>66</i>&nbsp;                      &quot; of a &quot; + d[2] + &quot;-channel ImagePlus.&quot;
<i>67</i>&nbsp;      );
<b class="nc"><i>68</i>&nbsp;      throw e;</b>
<i>69</i>&nbsp;    }
<b class="nc"><i>70</i>&nbsp;    ImageStack stack = myImPlus.getStack();</b>
<b class="nc"><i>71</i>&nbsp;    Matrix out = new Matrix(d[1], d[0]);</b>
<b class="nc"><i>72</i>&nbsp;    SummaryStatistics sumStat = new SummaryStatistics();</b>
<b class="nc"><i>73</i>&nbsp;    for (int x = 0; x != d[0]; ++x) {</b>
<b class="nc"><i>74</i>&nbsp;      for (int y = 0; y != d[1]; ++y) {</b>
<b class="nc"><i>75</i>&nbsp;        for (int z = 0; z != d[3]; ++z) {</b>
<b class="nc"><i>76</i>&nbsp;          sumStat.addValue(stack.getVoxel(x, y, z));</b>
<i>77</i>&nbsp;        }
<b class="nc"><i>78</i>&nbsp;        out.set(y, x, brightnessB(sumStat));</b>
<b class="nc"><i>79</i>&nbsp;        sumStat.clear();</b>
<i>80</i>&nbsp;      }
<i>81</i>&nbsp;    }
<b class="nc"><i>82</i>&nbsp;    return out;</b>
<i>83</i>&nbsp;  }
<i>84</i>&nbsp;
<i>85</i>&nbsp;  private static double[] colsBrightnessB(Matrix mat) {
<b class="fc"><i>86</i>&nbsp;    int nCol = mat.getColumnDimension();</b>
<b class="fc"><i>87</i>&nbsp;    int nRow = mat.getRowDimension();</b>
<b class="fc"><i>88</i>&nbsp;    double[] out = new double[nCol];</b>
<b class="fc"><i>89</i>&nbsp;    SummaryStatistics sumStat = new SummaryStatistics();</b>
<b class="fc"><i>90</i>&nbsp;    for (int col = 0; col != nCol; ++col) {</b>
<b class="fc"><i>91</i>&nbsp;      for (int row = 0; row != nRow; ++row) {</b>
<b class="fc"><i>92</i>&nbsp;        sumStat.addValue(mat.get(row, col));</b>
<i>93</i>&nbsp;      }
<b class="fc"><i>94</i>&nbsp;      out[col] = brightnessB(sumStat);</b>
<b class="fc"><i>95</i>&nbsp;      sumStat.clear();</b>
<i>96</i>&nbsp;    }
<b class="fc"><i>97</i>&nbsp;    return out;</b>
<i>98</i>&nbsp;  }
<i>99</i>&nbsp;
<i>100</i>&nbsp;  static double colsMeanBrightnessB(Matrix mat) {
<b class="fc"><i>101</i>&nbsp;    double[] cBB = colsBrightnessB(mat);</b>
<b class="fc"><i>102</i>&nbsp;    SummaryStatistics sumStat = new SummaryStatistics();</b>
<b class="fc"><i>103</i>&nbsp;    for (int col = 0; col != cBB.length; ++col) {</b>
<b class="fc"><i>104</i>&nbsp;      if (!Double.isNaN(cBB[col])) {</b>
<b class="fc"><i>105</i>&nbsp;        sumStat.addValue(cBB[col]);</b>
<i>106</i>&nbsp;      }
<i>107</i>&nbsp;    }
<b class="fc"><i>108</i>&nbsp;    long sumStatN = sumStat.getN();</b>
<b class="fc"><i>109</i>&nbsp;    if (sumStatN == 0) {</b>
<b class="nc"><i>110</i>&nbsp;      return Double.NaN;</b>
<i>111</i>&nbsp;    } else {
<b class="fc"><i>112</i>&nbsp;      return sumStat.getMean();</b>
<i>113</i>&nbsp;    }
<i>114</i>&nbsp;  }
<i>115</i>&nbsp;
<i>116</i>&nbsp;  static double[] rowsSums(Matrix mat) {
<b class="fc"><i>117</i>&nbsp;    int nRow = mat.getRowDimension();</b>
<b class="fc"><i>118</i>&nbsp;    int nCol = mat.getColumnDimension();</b>
<b class="fc"><i>119</i>&nbsp;    double[] out = new double[nRow];</b>
<b class="fc"><i>120</i>&nbsp;    SummaryStatistics sumStat = new SummaryStatistics();</b>
<b class="fc"><i>121</i>&nbsp;    for (int row = 0; row != nRow; ++row) {</b>
<b class="fc"><i>122</i>&nbsp;      for (int col = 0; col != nCol; ++col) {</b>
<b class="fc"><i>123</i>&nbsp;        sumStat.addValue(mat.get(row, col));</b>
<i>124</i>&nbsp;      }
<b class="fc"><i>125</i>&nbsp;      out[row] = sumStat.getSum();</b>
<b class="fc"><i>126</i>&nbsp;      sumStat.clear();</b>
<i>127</i>&nbsp;    }
<b class="fc"><i>128</i>&nbsp;    return out;</b>
<i>129</i>&nbsp;  }
<i>130</i>&nbsp;  static double[] colsSums(Matrix mat) {
<b class="nc"><i>131</i>&nbsp;    int nRow = mat.getRowDimension();</b>
<b class="nc"><i>132</i>&nbsp;    int nCol = mat.getColumnDimension();</b>
<b class="nc"><i>133</i>&nbsp;    double[] out = new double[nCol];</b>
<b class="nc"><i>134</i>&nbsp;    SummaryStatistics sumStat = new SummaryStatistics();</b>
<b class="nc"><i>135</i>&nbsp;    for (int col = 0; col != nCol; ++col) {</b>
<b class="nc"><i>136</i>&nbsp;      for (int row = 0; row != nRow; ++row) {</b>
<b class="nc"><i>137</i>&nbsp;        sumStat.addValue(mat.get(row, col));</b>
<i>138</i>&nbsp;      }
<b class="nc"><i>139</i>&nbsp;      out[col] = sumStat.getSum();</b>
<b class="nc"><i>140</i>&nbsp;      sumStat.clear();</b>
<i>141</i>&nbsp;    }
<b class="nc"><i>142</i>&nbsp;    return out;</b>
<i>143</i>&nbsp;  }
<i>144</i>&nbsp;  static double[] rowsMeans(Matrix mat) {
<b class="fc"><i>145</i>&nbsp;    int nRow = mat.getRowDimension();</b>
<b class="fc"><i>146</i>&nbsp;    int nCol = mat.getColumnDimension();</b>
<b class="fc"><i>147</i>&nbsp;    double[] out = rowsSums(mat);</b>
<b class="fc"><i>148</i>&nbsp;    for (int row = 0; row != nRow; ++row) {</b>
<b class="fc"><i>149</i>&nbsp;      out[row] /= nCol;</b>
<i>150</i>&nbsp;    }
<b class="fc"><i>151</i>&nbsp;    return out;</b>
<i>152</i>&nbsp;  }
<i>153</i>&nbsp;  static double[] colsMeans(Matrix mat) {
<b class="nc"><i>154</i>&nbsp;    int nRow = mat.getRowDimension();</b>
<b class="nc"><i>155</i>&nbsp;    int nCol = mat.getColumnDimension();</b>
<b class="nc"><i>156</i>&nbsp;    double[] out = colsSums(mat);</b>
<b class="nc"><i>157</i>&nbsp;    for (int col = 0; col != nCol; ++col) {</b>
<b class="nc"><i>158</i>&nbsp;      out[col] /= nRow;</b>
<i>159</i>&nbsp;    }
<b class="nc"><i>160</i>&nbsp;    return out;</b>
<i>161</i>&nbsp;  }
<i>162</i>&nbsp;
<i>163</i>&nbsp;  static boolean allAreNum(double[] data, double num) {
<b class="fc"><i>164</i>&nbsp;    for (double d : data) {</b>
<b class="fc"><i>165</i>&nbsp;      if (d != num) {</b>
<b class="fc"><i>166</i>&nbsp;        return false;</b>
<i>167</i>&nbsp;      }
<i>168</i>&nbsp;    }
<b class="fc"><i>169</i>&nbsp;    return true;</b>
<i>170</i>&nbsp;  }
<i>171</i>&nbsp;
<i>172</i>&nbsp;  static double absDiff(double x, double y) {
<b class="fc"><i>173</i>&nbsp;    return Math.abs(x - y);</b>
<i>174</i>&nbsp;  }
<i>175</i>&nbsp;  static int whichMin(double[] x) {
<b class="fc"><i>176</i>&nbsp;    int minIndex = 0;</b>
<b class="fc"><i>177</i>&nbsp;    double min = x[minIndex];</b>
<b class="fc"><i>178</i>&nbsp;    int l = x.length;</b>
<b class="fc"><i>179</i>&nbsp;    for (int i = 0; i != l; ++i) {</b>
<b class="fc"><i>180</i>&nbsp;      if (x[i] &lt; min) {</b>
<b class="fc"><i>181</i>&nbsp;        minIndex = i;</b>
<b class="fc"><i>182</i>&nbsp;        min = x[minIndex];</b>
<i>183</i>&nbsp;      }
<i>184</i>&nbsp;    }
<b class="fc"><i>185</i>&nbsp;    return minIndex;</b>
<i>186</i>&nbsp;  }
<i>187</i>&nbsp;
<i>188</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2018-09-30 18:05</div>
</div>
</body>
</html>
